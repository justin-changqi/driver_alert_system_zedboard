/*
 * common.c
 *
 *  Created on: Jun 17, 2018
 *      Author: justin
 */

#include "common.h"

void initEvevents()
{
	ask_sensor_data_.duration = 100;
	ask_sensor_data_.start_time = Timer_ms;
	flash_event_.duration = 1000;
	flash_event_.start_time = Timer_ms;
}

void updateEvevents(struct Event *event)
{
	printf("update %d\n\r", btn_value_);
	int current_time = Timer_ms;
	if (current_time - event->start_time > event->duration) {
		if (event == &ask_sensor_data_) {

		}
		if (event == &flash_event_) {
			LightHandler();
		}
	}
}

void LightHandler()
{
	static int count = 0;
	printf("btn: %d\n\r", btn_value_);
	switch(btn_value_) {
	case 0:
		SetGpioOut(0, GPIO_LED_L);
		SetGpioOut(0, GPIO_LED_R);
		break;
	case 1:
		SetGpioOut(count%2, GPIO_LED_L);
		break;
	case 2:
		SetGpioOut(count%2, GPIO_LED_R);
		break;
	default:
		break;

	}
	count++;
}
